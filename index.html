<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pink Christmas Tree</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: linear-gradient(#ff9acb, #ffd1e8);
  }
</style>
</head>
<body>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>

<script>
const scene = new THREE.Scene();

const camera = new THREE.PerspectiveCamera(
  55,
  window.innerWidth / window.innerHeight,
  0.1,
  100
);
camera.position.set(0, 6, 16);

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
document.body.appendChild(renderer.domElement);

/* 灯光（决定高级感） */
scene.add(new THREE.AmbientLight(0xffffff, 0.9));

const keyLight = new THREE.DirectionalLight(0xffffff, 0.9);
keyLight.position.set(5, 10, 5);
scene.add(keyLight);

/* 圣诞树 */
const tree = new THREE.Group();
scene.add(tree);

const treeMat = new THREE.MeshStandardMaterial({
  color: 0xff5fa2,
  roughness: 0.35,
  metalness: 0.15
});

for (let i = 0; i < 5; i++) {
  const geo = new THREE.ConeGeometry(5 - i, 3.5, 80);
  const cone = new THREE.Mesh(geo, treeMat);
  cone.position.y = i * 2.2;
  tree.add(cone);
}

/* 树干 */
const trunk = new THREE.Mesh(
  new THREE.CylinderGeometry(0.6, 0.8, 2.5, 32),
  new THREE.MeshStandardMaterial({ color: 0x7a3b3b })
);
trunk.position.y = -2;
tree.add(trunk);

/* 星星 */
const star = new THREE.Mesh(
  new THREE.IcosahedronGeometry(0.7),
  new THREE.MeshStandardMaterial({
    color: 0xfff0f7,
    emissive: 0xff9acb,
    emissiveIntensity: 1
  })
);
star.position.y = 11;
tree.add(star);

/* 雪花 */
const snowCount = 1200;
const snowGeo = new THREE.BufferGeometry();
const snowPos = [];

for (let i = 0; i < snowCount; i++) {
  snowPos.push(
    (Math.random() - 0.5) * 40,
    Math.random() * 30,
    (Math.random() - 0.5) * 40
  );
}

snowGeo.setAttribute('position',
  new THREE.Float32BufferAttribute(snowPos, 3)
);

const snow = new THREE.Points(
  snowGeo,
  new THREE.PointsMaterial({
    color: 0xffffff,
    size: 0.2,
    opacity: 0.8,
    transparent: true
  })
);
scene.add(snow);

/* 动画 */
function animate() {
  requestAnimationFrame(animate);

  tree.rotation.y += 0.003;

  const p = snow.geometry.attributes.position.array;
  for (let i = 1; i < p.length; i += 3) {
    p[i] -= 0.04;
    if (p[i] < -5) p[i] = 30;
  }
  snow.geometry.attributes.position.needsUpdate = true;

  renderer.render(scene, camera);
}

animate();

window.addEventListener('resize', () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>

</body>
</html>
